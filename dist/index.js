(()=>{"use strict";var e={42:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,u){function i(e){try{s(n.next(e))}catch(e){u(e)}}function a(e){try{s(n.throw(e))}catch(e){u(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}s((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function a(u){return function(a){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,n=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=t.call(e,i)}catch(e){u=[6,e],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,a])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getContent=void 0;var i=u(r(193)),a=r(681);t.getContent=function(e,t,r){return n(void 0,void 0,void 0,(function(){var n,u,s,c,l;return o(this,(function(o){switch(o.label){case 0:if(!(n=e.query.url))return[2,r(i.default.badRequest("Missing url"))];if("string"!=typeof n)return[2,r(i.default.badRequest("Query param 'url' has to be of type string"))];o.label=1;case 1:return o.trys.push([1,9,,10]),[4,a.firefox.launch({headless:!0})];case 2:return[4,(u=o.sent()).newContext()];case 3:return[4,o.sent().newPage()];case 4:return[4,(s=o.sent()).goto(n,{waitUntil:"load",timeout:0})];case 5:return o.sent(),[4,s.waitForSelector("body")];case 6:return o.sent(),[4,s.evaluate((function(){var e=function(e){var t=e.querySelector("article");if(t)return t;var r=e.querySelector("main");return r||e}(document.body),t=function(e){return e.replace(/\s+/gi," ").trim()},r=function(e,t){var r,n=null==e?void 0:e.querySelector(t);return null!==(r=null==n?void 0:n.innerText)&&void 0!==r?r:""},n=Array.from(e.querySelectorAll("img")).reduce((function(e,t){var r=t.src;return r&&!e.includes(r)&&e.push(r),e}),[]),o=Array.from(document.querySelectorAll("a")).reduce((function(e,t){try{var r=t.href,n=new URL(r);e.includes(r)||document.URL.includes(n.origin)||e.push(r)}catch(e){}return e}),[]);return{title:document.title,lastModified:document.lastModified,description:t(function(e){var t,r=null===(t=e.querySelector('meta[name="description"]'))||void 0===t?void 0:t.getAttribute("content");return null!=r?r:""}(document)),text:t(e.innerText),comments:function(e){var t=e.querySelectorAll('[itemtype="http://schema.org/Comment"]');return Array.from(t).map((function(e){var t,n=e.querySelector('[itemprop="dateCreated"]'),o=null!==(t=null==n?void 0:n.getAttribute("datetime"))&&void 0!==t?t:"";return{user:r(e,'[itemprop="author"]'),text:r(e,'[itemprop="text"]'),dateCreated:o}}))}(document),images:n,externalLinks:o,author:t(function(e){var t,n=null===(t=e.querySelector('meta[name="author"]'))||void 0===t?void 0:t.getAttribute("content");if(n)return n;var o=r(e,'[itemtype="https://schema.org/Person"][itemprop="author"] [itemprop="name"]');if(o)return o;var u=r(e,'.author, #author, [name="author"]');return u||""}(document))}}))];case 7:return c=o.sent(),[4,u.close()];case 8:return o.sent(),[2,t.status(200).json(c).end()];case 9:return l=o.sent(),r(l),[3,10];case 10:return[2]}}))}))}},45:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(42),t)},193:function(e,t){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(r,n,o){var u=e.call(this,n,o)||this;return u.status=r,u.errors=o,Object.setPrototypeOf(u,t.prototype),u}return n(t,e),t.unauthorized=function(e,r){return void 0===e&&(e="User unauthorized"),void 0===r&&(r=[]),new t(401,e,r)},t.badRequest=function(e,r){return void 0===e&&(e="Bad request"),void 0===r&&(r=[]),new t(400,e,r)},t.forbidden=function(e,r){return void 0===e&&(e="Forbidden"),void 0===r&&(r=[]),new t(403,e,r)},t.notFound=function(e,r){return void 0===e&&(e="Not found"),void 0===r&&(r=[]),new t(404,e,r)},t.internalError=function(e,r){return void 0===e&&(e="Internal Server Error"),void 0===r&&(r=[]),new t(500,e,r)},t}(Error);t.default=o},607:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),r(81);var o=n(r(860)),u=n(r(479)),i=n(r(582)),a=r(263),s=(0,o.default)();s.use(o.default.urlencoded({extended:!0})),s.use(o.default.json()),s.use((0,i.default)({credentials:!0,origin:process.env.REQUEST_ORIGIN})),s.use(u.default),s.use(a.errorMiddleware);var c=process.env.PORT||3001;s.listen(c,(function(){console.log("Server listening on port: ".concat(c))}))},263:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.errorMiddleware=void 0;var o=n(r(193));t.errorMiddleware=function(e,t,r,n){return console.log(e),e instanceof o.default?r.status(e.status).send({message:e.message,errors:e.errors}).end():r.status(500).json({message:"Internal Server Error",errors:[e.stack]}).end()}},479:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(860)),u=r(45),i=o.default.Router();i.get("/api/v1/",u.getContent),t.default=i},582:e=>{e.exports=require("cors")},81:e=>{e.exports=require("dotenv/config")},860:e=>{e.exports=require("express")},681:e=>{e.exports=require("playwright")}},t={};var r=function r(n){var o=t[n];if(void 0!==o)return o.exports;var u=t[n]={exports:{}};return e[n].call(u.exports,u,u.exports,r),u.exports}(607),n=exports;for(var o in r)n[o]=r[o];r.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();